# Supabase

- CRA, React.js, TypeScript, Supabase 관련 테이블 만들기
- SQL 공부
  - [https://www.w3schools.com/sql/](https://www.w3schools.com/sql/sql_injection.asp)
  - [https://www.postgresql.org/docs/12/arrays.html](https://www.postgresql.org/docs/12/arrays.html)
  - [https://www.sqlshack.com/implement-array-like-functionality-sql-server/](https://www.sqlshack.com/implement-array-like-functionality-sql-server/)
  - [https://www.postgresql.org/docs/12/arrays.html](https://www.postgresql.org/docs/12/arrays.html)
  - 만다라트에서 1개의 목표마다 8개의 하위 목표 노드가 있는데 array 8 8로 하는게 어려워서 못찾고 있음
  - [https://github.com/supabase/examples-archive/tree/main/supabase-js-v1/todo-list/react-todo-list-typescript](https://github.com/supabase/examples-archive/tree/main/supabase-js-v1/todo-list/react-todo-list-typescript)

```sql
create table mandalart (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users not null,
  mandalart_goal text check(char_length(mandalart_goal) > 3)
);

create table goal_table (
    id bigint generated by default as identity primary key,
    user_id uuid references auth.users not null,
    core_goal text check(char_length(core_goal) > 3),
    goal_array text array[8]
);

alter table mandalart enable row level security;
alter table goal_table enable row level security;
-- Add goal_table to mandalart table
alter table mandalart 
    add column goal_id bigint references goal_table;

create policy "Individuals can create goal_table." on goal_table for
    insert with check (auth.uid() = user_id);

create policy "Individuals can view their own goal_table. " on goal_table for
    select using (auth.uid() = user_id);

create policy "Individuals can update their own goal_table." on goal_table for
    update using (auth.uid() = user_id);

create policy "Individuals can delete their own goal_table." on goal_table for
    delete using (auth.uid() = user_id);
```